{
  "hash": "e99fdd2f2b2aba62fb5d89567cf4905b",
  "result": {
    "markdown": "---\ntitle: \"TwinStick Data Summary\"\n\nformat: html\n\ncode-fold: true\n---\n\n\nThe purpose of this document is to consistently summarize the data from Project TwinStick, allowing us to more consistently test the evolutionary model and gameplay during development.\n\n## Data\n\nIn this section, we ingest the data from whatever runs are relevant to the analysis. The data are written from the project in `.csv` files. The following code reads all `.csv` files from the working directory. It creates new variables for the source file name (`file`) and the number of offspring produced by each individual (`offspring_count`). It then appends all the data files into a single data frame called `allfiles`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(pheatmap)\n\n\nfiles <- list.files(pattern = \"*.csv\", full.names = TRUE)\n\nallfiles = data.frame()\nfor(csv in files){\n  Twin3 <- read.csv(csv, as.is=T, header=T)\n  Twin3['file'] = csv\n\n\nTwin3<-Twin3%>%\n  mutate(Unique.Slime.ID = paste(Wave.Number, \".\", Slime.ID))%>%\n  mutate(Unique.Parent.One = paste(Wave.Number-1, \".\", Parent.One))%>%\n  mutate(Unique.Parent.Two = paste(Wave.Number-1, \".\", Parent.Two))\n\n\ndf_parents <- Twin3 %>%\n  select(Unique.Parent.One, Unique.Parent.Two) %>%\n  pivot_longer(cols = everything(), names_to = \"parent_type\", values_to = \"parent_id\")\n\n# Count the number of offspring for each parent\noffspring_counts <- df_parents %>%\n  group_by(parent_id) %>%\n  summarise(offspring_count = n(), .groups = \"drop\")\n\noffspring_counts <- offspring_counts%>%\n  filter(parent_id != \"-1 . N/A\")\n\n\noffspring_counts<- rename(offspring_counts, Unique.Slime.ID = parent_id)\n\n\n\nTwin3 <- Twin3 %>%\n  left_join(offspring_counts, by = \"Unique.Slime.ID\")%>%\n  replace_na(list(offspring_count = 0))\n\nallfiles<-rbind(allfiles,Twin3)\n\n}\n\nallfiles<-allfiles%>%\n  select(-X)%>%\n  mutate(Lightning.Resist.Trait = case_when(\n    Main.Type == \"Lightning\" & Secondary.Type == \"Lightning\" ~ 0.5 + Secondary.Resistance.Trait,\n    Main.Type == \"Lightning\" & Secondary.Type != \"Lightning\" ~ 0.5 ,\n    Main.Type != \"Lightning\" & Secondary.Type == \"Lightning\" ~ Secondary.Resistance.Trait,\n    Main.Type != \"Lightning\" & Secondary.Type != \"Lightning\" ~ 0,\n    TRUE ~ 0\n  ))\n\n\nTraits <- c(\"Lightning.Resist.Trait\", \"Main.Resistance.Trait\", \"Secondary.Resistance.Trait\", \"Speed.Trait\",\n           \"Tower.Attraction.Trait\", \"Slime.Optimal.Distance.Trait\", \"Turn.Rate.Trait\", \n           \"Slime.View.Range.Trait\", \"Tower.View.Range.Trait\")\n\nGenes <- c(\"Main.Resistance.Gene\", \"Secondary.Resistance.Gene\", \"Speed.Gene\",\n           \"Tower.Attraction.Gene\", \"Slime.Optimal.Distance.Gene\", \"Turn.Rate.Gene\", \n           \"Slime.View.Range.Gene\", \"Tower.View.Range.Gene\")\n\nallfiles<-allfiles%>%\n  mutate(Generation=as.factor(Wave.Number))%>%\n  mutate(offspring.count.Fitness = offspring_count) %>%\n   mutate(Actual.Distance.Fitness = (Player.Distance.Fitness/50000) -1)\n\nTraitAvg <- allfiles %>%\n  group_by(file, Generation) %>%\n  summarize(across(ends_with(\"Trait\"), mean,  na.rm = TRUE))\n\nGeneAvg <- allfiles %>%\n  group_by(file, Generation) %>%\n  summarize(across(ends_with(\"Gene\"), list(mean = mean, var = var), na.rm = TRUE, .names = \"{.fn}.{.col}\"))\n\nFitAvg <- allfiles %>%\n  group_by(file, Generation) %>%\n  summarize(across(ends_with(\"Fitness\"), list(mean = mean, var = var), na.rm = TRUE, .names = \"{.fn}.{.col}\"))\n```\n:::\n\n\nThe `allfiles` dataframe contains the following variables (I also show a few columns of the example data):\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata.dictionary <- t(as.data.frame(head(allfiles)))\nknitr::kable(data.dictionary)\n```\n\n::: {.cell-output-display}\n|                             |1                                      |2                                      |3                                      |4                                      |5                                      |6                                      |\n|:----------------------------|:--------------------------------------|:--------------------------------------|:--------------------------------------|:--------------------------------------|:--------------------------------------|:--------------------------------------|\n|Slime.ID                     |0                                      |1                                      |2                                      |3                                      |4                                      |5                                      |\n|Wave.Number                  |0                                      |0                                      |0                                      |0                                      |0                                      |0                                      |\n|Path.Distance.To.Player      |0                                      |0                                      |0                                      |0                                      |0                                      |0                                      |\n|Player.Distance.Fitness      |878.0573                               |942.4612                               |1099.4340                              |923.3716                               |923.5927                               |956.4991                               |\n|Parent.One                   |N/A                                    |N/A                                    |N/A                                    |N/A                                    |N/A                                    |N/A                                    |\n|Parent.Two                   |N/A                                    |N/A                                    |N/A                                    |N/A                                    |N/A                                    |N/A                                    |\n|Main.Type                    |Fire                                   |Player                                 |Fire                                   |Blaster                                |Balanced                               |Fire                                   |\n|Secondary.Type               |Lightning                              |Player                                 |Blaster                                |Blaster                                |Player                                 |Balanced                               |\n|Main.Resistance.Gene         |2.060887000                            |2.872348000                            |1.006045000                            |-0.008765968                           |-0.950339600                           |-1.279348000                           |\n|Main.Resistance.Trait        |0.5781593                              |0.6267003                              |0.5128749                              |0.4496236                              |0.3923166                              |0.3728904                              |\n|Secondary.Resistance.Gene    |0.01938968                             |-0.46283390                            |2.65991700                             |2.17777000                             |1.29421200                             |2.88058900                             |\n|Secondary.Resistance.Trait   |0.1831496                              |0.1657976                              |0.3025845                              |0.2777685                              |0.2356916                              |0.3143516                              |\n|Slime.View.Range.Gene        |1.45217100                             |-4.52872900                            |0.41324340                             |-0.08973839                            |1.15681100                             |1.33135500                             |\n|Slime.View.Range.Trait       |9.846652                               |4.656380                               |8.887072                               |8.415874                               |9.577014                               |9.736749                               |\n|Tower.View.Range.Gene        |0.7422258                              |-2.4267900                             |-0.1783606                             |-1.0232440                             |1.5237570                              |-1.4051460                             |\n|Tower.View.Range.Trait       |22.85026                               |15.11252                               |20.55417                               |18.45575                               |24.76398                               |17.52282                               |\n|Player.View.Range.Gene       |-0.70632820                            |-0.01583275                            |-0.06684434                            |0.40760770                             |-0.34967610                            |-2.37537300                            |\n|Player.View.Range.Trait      |3.356673                               |3.681639                               |3.656685                               |3.894415                               |3.521046                               |2.688438                               |\n|Wall.View.Range.Gene         |0.13138430                             |0.20673470                             |1.63018500                             |4.42545100                             |0.04316422                             |2.65278900                             |\n|Wall.View.Range.Trait        |5.131722                               |5.188353                               |6.341081                               |8.898485                               |5.066026                               |7.248795                               |\n|Sheep.View.Range.Gene        |1.77112100                             |0.03020487                             |0.63438080                             |3.76045600                             |-2.25865400                            |3.12416400                             |\n|Sheep.View.Range.Trait       |6.462865                               |5.056430                               |5.518585                               |8.275494                               |3.594677                               |7.682169                               |\n|Slime.Attraction.Gene        |-0.97361480                            |0.02759038                             |-0.08706515                            |0.41256310                             |1.06375000                             |0.37561050                             |\n|Slime.Attraction.Trait       |0.4394477                              |0.5017244                              |0.4945587                              |0.5257624                              |0.5660953                              |0.5234584                              |\n|Tower.Attraction.Gene        |-0.4425031                             |0.1369935                              |0.7489339                              |-0.6538926                             |0.1313944                              |-0.8749940                             |\n|Tower.Attraction.Trait       |-0.9880077                             |-0.9861512                             |-0.9838803                             |-0.9886215                             |-0.9861704                             |-0.9892301                             |\n|Player.Attraction.Gene       |-0.6821441                             |-1.6283370                             |3.9870850                              |4.2225470                              |-3.0099490                             |1.2839510                              |\n|Player.Attraction.Trait      |0.01473093                             |-0.10317370                            |0.53589990                             |0.55654820                             |-0.26942490                            |0.25475740                             |\n|Wall.Attraction.Gene         |0.1195688                              |1.1711760                              |-0.2865770                             |0.7249610                              |1.3997780                              |-1.4818690                             |\n|Wall.Attraction.Trait        |-0.8776227                             |-0.8464735                             |-0.8881165                             |-0.8604172                             |-0.8388985                             |-0.9145474                             |\n|Sheep.Attraction.Gene        |0.8572116                              |-1.3909040                             |-2.0276770                             |-1.3564410                             |-0.8138410                             |1.9432800                              |\n|Sheep.Attraction.Trait       |0.7710594                              |0.6575227                              |0.6208318                              |0.6594602                              |0.6892338                              |0.8154501                              |\n|Slime.Optimal.Distance.Gene  |0.2664202                              |-0.2785142                             |-2.2960630                             |1.5807830                              |3.4963320                              |0.9412469                              |\n|Slime.Optimal.Distance.Trait |0.27595890                             |0.21192480                             |-0.03699094                            |0.41992250                             |0.59607800                             |0.35193960                             |\n|Speed.Gene                   |2.67080900                             |0.76555180                             |3.71029500                             |0.56656130                             |-0.08200173                            |-2.95797200                            |\n|Speed.Trait                  |3.594294                               |2.798228                               |4.074744                               |2.722425                               |2.485705                               |1.628774                               |\n|Turn.Rate.Gene               |-2.0039470                             |0.3158437                              |0.5855277                              |5.9859360                              |0.6421707                              |1.5284210                              |\n|Turn.Rate.Trait              |0.1190994                              |0.1944987                              |0.2052795                              |0.4991210                              |0.2075993                              |0.2464020                              |\n|Sprint.Duration.Gene         |0.3580502                              |-1.4255720                             |0.9057481                              |-0.9512499                             |-2.5994610                             |-0.4005764                             |\n|Sprint.Duration.Trait        |2.611816                               |2.059165                               |2.781843                               |2.204128                               |1.715100                               |2.374924                               |\n|Sprint.Cooldown.Gene         |0.1790418                              |-2.5914650                             |-1.9531460                             |-0.6929213                             |4.2617590                              |1.3097360                              |\n|Sprint.Cooldown.Trait        |2.7232060                              |0.3484487                              |0.6210535                              |1.6669180                              |4.9304920                              |3.9373440                              |\n|file                         |./geneWriteFile08_07_2023_12-54-56.csv |./geneWriteFile08_07_2023_12-54-56.csv |./geneWriteFile08_07_2023_12-54-56.csv |./geneWriteFile08_07_2023_12-54-56.csv |./geneWriteFile08_07_2023_12-54-56.csv |./geneWriteFile08_07_2023_12-54-56.csv |\n|Unique.Slime.ID              |0 . 0                                  |0 . 1                                  |0 . 2                                  |0 . 3                                  |0 . 4                                  |0 . 5                                  |\n|Unique.Parent.One            |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |\n|Unique.Parent.Two            |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |\n|offspring_count              |3                                      |1                                      |4                                      |4                                      |0                                      |0                                      |\n|Lightning.Resist.Trait       |0.1831496                              |0.0000000                              |0.0000000                              |0.0000000                              |0.0000000                              |0.0000000                              |\n|Generation                   |0                                      |0                                      |0                                      |0                                      |0                                      |0                                      |\n|offspring.count.Fitness      |3                                      |1                                      |4                                      |4                                      |0                                      |0                                      |\n|Actual.Distance.Fitness      |-0.9824389                             |-0.9811508                             |-0.9780113                             |-0.9815326                             |-0.9815281                             |-0.9808700                             |\n:::\n:::\n\n\nVariables that end in `.Gene` are the values of the genome for that particular locus. Variables that end in `.Trait` are the values of the trait for that particular locus.\n\n## Experimental Conditions\n\n**Use this section to describe the goal of the data collection and the key conditions that define the test.**\n\nThis test occurred July 21, 2023 and was focused on the new fitness functions implemented by Justin. We are interested in determining whether the fitness functions work correctly.\n\nThe conditions were a standard \"L\" shaped set of walls with four lightning towers. The slimes acquire fitness by getting close to the player using a formula of 50,000 / (path distance +1). For replicates 4-6, Justin corrected the math concerning the `~.Resistance.~` genes.\n\n## Slime Types\n\nEach Slime has a `Main.Type` and a `Secondary.Type`. These types use the `~.Resistance.~` category to confer resistance to the appropriate damage type. Under certain experimental conditions, we would expect the `~.Type` and `~.Resistance.~` genes and traits to evolve in response to the predominant damage type delivered by the player.\n\nThe following code creates two summary dataframes with the suffix `~Typecounts` that count the number of slimes of each `~.Type` in each generation for each replicate. It then creates the graphs of `~Type` frequency over time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMainTypecounts <- allfiles %>%\n  group_by(Main.Type, Generation, file) %>%\n  summarise(Main.count = n(), .groups = \"drop\")\n\nSecondaryTypecounts <- allfiles %>%\n  group_by(Secondary.Type, Generation, file) %>%\n  summarise(Secondary.count = n(), .groups = \"drop\")\n\n            \n\nggplot(MainTypecounts, aes(x = Generation, y = Main.count, fill = as.factor(Main.Type))) +\n  geom_col(position = \"stack\") +\n  labs(x = \"Generation\", y = \"Count\", fill = \"Main Slime Type\") +\n  theme_minimal()+\n  facet_wrap(~file, ncol=2)\n```\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(SecondaryTypecounts, aes(x = Generation, y = Secondary.count, fill = as.factor(Secondary.Type))) +\n  geom_col(position = \"stack\") +\n  labs(x = \"Generation\", y = \"Count\", fill = \"Secondary Slime Type\") +\n  theme_minimal()+\n  facet_wrap(~file, ncol=2)\n```\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\n## Slime Fitness\n\nThis section should summarize the behavior of the fitness function. The fitness function calculates a value of 50,000/(distance to player +1). I will also reverse calculate that for visualization.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(allfiles, aes(x=Wave.Number, y= Player.Distance.Fitness))+\n  geom_point(aes(x=Wave.Number, y= Player.Distance.Fitness, color = offspring_count),alpha =0.1)+\n  geom_smooth()+\n  facet_wrap(~file, ncol = 2)+\n  scale_color_continuous(low=\"blue\", high = \"red\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = \"cs\")'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = FitAvg, aes(x = as.numeric(Generation), y = var.offspring.count.Fitness))+\n    geom_point()+\n    geom_smooth(method = \"loess\") +\n    theme(legend.position = \"none\") +\n    facet_wrap(~file, ncol = 2) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(allfiles, aes(x = as.factor(Wave.Number), y = Player.Distance.Fitness, fill = Wave.Number)) + \n  geom_violin() +\n  theme(legend.position = \"none\")+\n  facet_wrap(~file, ncol = 2)\n```\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n\n```{.r .cell-code}\ntraittemp<-allfiles%>%\n  select(Generation, offspring_count, file, Player.Distance.Fitness)%>%\n  group_by(Generation, file)%>%\n  mutate(scaleST0 = scale(Player.Distance.Fitness, center = TRUE))%>%\n  mutate(scaleST02 = scaleST0*scaleST0)%>%\n  mutate(Generation = as.numeric(Generation))\n\nGradients <- traittemp %>%\n  group_by(Generation, file) %>%\n  do({\n    model <- lm(offspring_count ~ scaleST0 + scaleST02, data = .)\n    data.frame(\n      Beta = coefficients(model)[2],\n      PB = summary(model)$coef[2, 4]\n    )\n  })\n\nGradients <- Gradients %>%\n  mutate(sig = if_else(PB < 0.05 , \"Y\", \"N\"))\n\n\n\nggplot(Gradients, aes(x=Generation, y = Beta))+\n  geom_point(aes(color = sig))+\n  geom_smooth(fill=\"blue\")+\n  scale_color_manual(values = c(\"red\",\"grey\"))+\n  geom_hline(yintercept=0, linetype=\"dashed\", color = \"black\")+\n  theme(legend.position = \"none\",\n        panel.background = element_blank())+\n  facet_wrap(~file)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-4-4.png){width=672}\n:::\n:::\n\n\n## Trait Evolution\n\nThis section should summarize the patterns of trait evolution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in seq_along(Traits)){\n\n  plot <- ggplot(data = TraitAvg, aes(x = as.numeric(Generation), y = !!sym(Traits[i])))+\n    geom_smooth(data = TraitAvg, aes(x = as.numeric(Generation), y = !!sym(Traits[i])), method = \"loess\") +\n    geom_point(data=allfiles, aes(x = as.numeric(Generation), y = !!sym(Traits[i]), color = offspring_count), size = 0.5, alpha =0.1)+\n    theme(legend.position = \"none\") +\n    facet_wrap(~file, ncol = 2) \n\n  print(plot)\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-5-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-5-5.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-5-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-5-7.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-5-8.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-5-9.png){width=672}\n:::\n:::\n\n\n## Gene Evolution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in seq_along(Genes)){\n\n  plot <- ggplot(data = GeneAvg, aes(x = as.numeric(Generation), y = !!sym(paste(\"mean.\",Genes[i], sep = \"\"))))+\n    geom_point(data = allfiles, aes(x = as.numeric(Generation), y = !!sym(Genes[i])), size=0.1, alpha = 0.02)+\n    geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y = !!sym(paste(\"mean.\",Genes[i], sep = \"\")), method = \"loess\")) +\n    theme(legend.position = \"none\") +\n    facet_wrap(~file, ncol = 2) \n\n  print(plot)\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-6-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-6-5.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-6-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-6-7.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](TwinStick_files/figure-html/unnamed-chunk-6-8.png){width=672}\n:::\n:::\n\n\n## Heatmap\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmaxwave = max(allfiles$Wave.Number)\n\nTwin3 <- Twin3 %>%\n  select(Wave.Number, Slime.ID, Player.Distance.Fitness, Main.Resistance.Trait, Secondary.Resistance.Trait, Slime.View.Range.Trait, \n         Tower.View.Range.Trait, Player.View.Range.Trait, Wall.View.Range.Trait, Sheep.View.Range.Trait, Slime.Attraction.Trait, \n         Tower.Attraction.Trait, Player.Attraction.Trait, Wall.Attraction.Trait, Sheep.Attraction.Trait, Slime.Optimal.Distance.Trait, \n         Speed.Trait, Turn.Rate.Trait, Sprint.Duration.Trait, Sprint.Cooldown.Trait, offspring_count) %>%\n  filter(Wave.Number == maxwave)\n\npaletteLength <- 50\nmyColor <- colorRampPalette(c(\"blue\", \"white\", \"#ED2024\"))(paletteLength)\n# length(breaks) == length(paletteLength) + 1\n# use floor and ceiling to deal with even/odd length pallettelengths\n\n\nHeatmap <- Twin3 %>%\n  select(Player.Distance.Fitness, Main.Resistance.Trait, Secondary.Resistance.Trait, Slime.View.Range.Trait, \n         Tower.View.Range.Trait, Player.View.Range.Trait, Wall.View.Range.Trait, Sheep.View.Range.Trait, Slime.Attraction.Trait, \n         Tower.Attraction.Trait, Player.Attraction.Trait, Wall.Attraction.Trait, Sheep.Attraction.Trait, Slime.Optimal.Distance.Trait, \n         Speed.Trait, Turn.Rate.Trait, Sprint.Duration.Trait, Sprint.Cooldown.Trait)\n\nHeatmap <- scale(Heatmap)\n\ncolnames(Heatmap) <- c('Fitness', 'Main Resistance', 'Secondary Resistance', 'Slime View Range', 'Tower Viewe Range', 'Player View Range',\n                        'Wall View Range', 'Sheep View Range', 'Slime Attraction', 'Tower Attraction', 'Player Attraction', 'Wall Attraction',\n                        'Sheep Attraction', 'Slime Optimal Distance', 'Speed', 'Turn Rate', 'Sprint Duration', 'Sprint Cooldown')\n\nHeatmatrix2 <- as.matrix(Heatmap)\n\nmyBreaks2 <- c(seq(min(Heatmatrix2), 0, length.out=ceiling(paletteLength/2) + 1), seq(max(Heatmatrix2)/paletteLength, max(Heatmatrix2), \n                                                                                      length.out=floor(paletteLength/2)))\n\nheatmap1 = pheatmap(Heatmatrix2,\n         cluster_rows = TRUE, # don't cluster rows\n         cluster_cols = TRUE, # don't cluster columns\n         clustering_distance_cols = \"euclidean\",\n         clustering_distance_rows = \"euclidean\",\n         clustering_method = \"complete\",\n         kmeans_k = 20,\n         cellheight = 8,\n         fontsize_row = 8,\n         color = myColor,\n         breaks = myBreaks2,\n         border_color = NA)\n\nheatmap2 = pheatmap(Heatmatrix2,\n         cluster_rows = TRUE, # don't cluster rows\n         cluster_cols = TRUE, # don't cluster columns\n         clustering_distance_cols = \"euclidean\",\n         clustering_distance_rows = \"euclidean\",\n         clustering_method = \"complete\",\n         color = myColor,\n         breaks = myBreaks2)\n```\n:::\n",
    "supporting": [
      "TwinStick_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}